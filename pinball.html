<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
        <style>
            /* CSS */

        </style>

        <title>Pinball</title>
    </head>
    <body>
        <!-- HTML -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
         <!-- planck -->
        <script src="https://cdn.jsdelivr.net/npm/planck@latest/dist/planck.min.js"></script>
        <!-- Version 3 of p5.play -->
        <script src="https://p5play.org/v3/p5play.js"></script>

        <h1>Click mouse to spawn the ball</h1>
        <h1>'Q' controls the left flipper & 'E' controls the right flipper</h1>

        <script>
            // JS

            //The ball as well as the flippers and basic walls
            let ball;
            let active =false; //Boolean val for only letting 1 ball at a time
            let flipperLeft;
            let flipperRight;
            let leftWall;
            let rightWall;
            let bottomLeftWall;
            let bottomRightWall;
            let topWall;

            //Obstacles
            let topTriangle;
            let middleTriangle;
            let leftTriangle;
            let rightTriangle;
            let smallPlatformLeft;
            let smallPlatformRight;

            //Point shapes
            let fiftyPoint;
            let thrityPoint;
            let twentyPoint;
            let tenPoint;

            function setup() {
                new Canvas(750,950);
                world.gravity.y = 10;

                //Setting up the flippers
                flipperLeft= new Sprite(210,740,180,25);
                flipperLeft.color='lime';
                flipperRight= new Sprite(540,740,180,25);
                flipperRight.color='lime';
                flipperLeft.collider = 'kinematic';
                flipperRight.collider = 'kinematic';
                flipperLeft.offset.x = 60;
                flipperRight.offset.x = -60;
                flipperLeft.rotateTo(30);
                flipperRight.rotateTo(-30);

                //Setting up the walls
                leftWall= new Sprite(125,325,20,550);
                rightWall= new Sprite(625,325,20,550);
                bottomLeftWall= new Sprite(145,660,20,120);
                bottomLeftWall.rotation= 150;
                bottomRightWall= new Sprite(605,660,20,120);
                bottomRightWall.rotation= -150;
                topWall= new Sprite(375,40,520,20);
                leftWall.collider= 'static';
                rightWall.collider= 'static';
                bottomLeftWall.collider= 'static';
                bottomRightWall.collider= 'static';
                topWall.collider= 'static';
                leftWall.color= 'green';
                rightWall.color= 'green';
                bottomLeftWall.color= 'green';
                bottomRightWall.color= 'green';
                topWall.color= 'green';

                //Setting up the obstacles
                topTriangle= new Sprite([[375, 100],[440, 150],[310, 150], [375, 100]]);
                middleTriangle= new Sprite([[375, 325],[430, 400],[320, 400], [375, 325]]);
                leftTriangle= new Sprite([[200,500],[200,600],[280,650],[200,500]]);
                rightTriangle= new Sprite([[550,500],[550,600],[470,650],[550,500]]);
                smallPlatformLeft = new Sprite(220,175,20,100);
                smallPlatformLeft.rotation= 35;
                smallPlatformRight= new Sprite(530,175,20,100);
                smallPlatformRight.rotation= -35;
                topTriangle.collider='static';
                middleTriangle.collider='static';
                leftTriangle.collider= 'static';
                rightTriangle.collider= 'static';
                smallPlatformLeft.collider= 'static';
                smallPlatformRight.collider= 'static';
                topTriangle.color='green';
                middleTriangle.color='green';
                leftTriangle.color= 'green';
                rightTriangle.color= 'green';
                smallPlatformLeft.color= 'green';
                smallPlatformRight.color= 'green';

            }

            function draw() {
                clear();
                background(20);
            }

            function mousePressed() { //Allows user to spawn 1 ball
                if(active==false){
                    if(mouseX>130 && mouseX<620){ //Only will spawn the ball if user clicks within pinball area
                        ball = new Sprite(mouseX,65,30);
                        ball.color= 'lime';
                        active=true; //Will make sure no more balls could spawn
                    }
                }
            }

            function keyPressed(){
                if(key=='q'){ //If q is pressed then tilt the flipper upwards
                    flipperLeft.rotateTo(-45,7);
                }
                else if(key=='e'){  //If e is pressed then tilt the flipper upwards
                    flipperRight.rotateTo(45,7);
                }
            }

            function keyReleased(){
                if(key=='q'){ //If q is released return flipper to the default position
                    flipperLeft.rotateTo(30,7);
                }
                else if(key=='e'){ //If e is released return flipper to the default position
                    flipperRight.rotateTo(-30,7);
                }
            }


        </script>
    </body>
</html>
